# Pixelto 首页重设计 - 技术设计

## 1. 技术架构

### 1.1 技术栈

**前端框架**：
- Next.js 16 (App Router)
- React 19
- TypeScript 5.9

**UI 组件**：
- Shadcn UI + Radix UI
- Tailwind CSS 4
- Framer Motion（动画）

**后端 & 数据**：
- Server Actions（表单处理）
- Prisma（数据库 ORM）
- Resend（邮件服务）

**AI 集成**：
- Google Gemini API（图像编辑）

---

## 2. 组件架构

### 2.1 首页组件树

```
app/(marketing)/[locale]/(home)/page.tsx
├── ParticleBackground (首屏背景，z-0)
├── Hero (z-10)
│   ├── Badge (参考图一，Logo+Title+Slogan)
│   ├── Heading (H1)
│   └── Subheading
├── AIImageEditor (独立模块，已有)
│   ├── AIImageEdit (输入组件)
│   ├── CreationHistory (历史记录)
│   └── LivePreview (预览模态框)
├── Showcase
│   ├── SectionHeader
│   └── ImageGrid
│       └── ShowcaseCard (Hover 效果)
├── Features
│   ├── SectionHeader
│   └── FeatureGrid
│       └── FeatureCard (Icon + 标题 + 描述)
├── FAQ
│   ├── SectionHeader
│   └── Accordion (Shadcn)
└── CTA
    ├── Heading
    ├── Subheading
    └── CTAButtons
```

---

## 3. 关键组件设计

### 3.1 ParticleBackground 优化

**调整方案**：
- 从 `AIImageEditor.tsx` 移至 `page.tsx`
- 覆盖整个首屏视口（Hero + Editor 区域）
- 使用 `fixed` 定位，z-index: 0

**实现**：
```tsx
// apps/web/app/(marketing)/[locale]/(home)/page.tsx

export default function Home() {
  return (
    <main className="relative">
      {/* 首屏背景 */}
      <div className="fixed inset-0 z-0 h-screen">
        <ParticleBackground />
        <div className="absolute inset-0 bg-gradient-to-b from-background/30 via-background/50 to-background" />
      </div>

      {/* 内容（z-10+） */}
      <div className="relative z-10">
        <Hero />
        <AIImageEditor />
        <Showcase />
        {/* ... */}
      </div>
    </main>
  );
}
```

**性能优化**：
- 粒子数量根据设备性能调整（移动端 150，桌面端 400）
- 使用 `requestAnimationFrame` 确保 60fps
- 在低性能设备上禁用（检测 `navigator.hardwareConcurrency`）

---

### 3.2 Hero 组件

**Props 接口**：
```typescript
interface HeroProps {
  locale: string; // 从 page.tsx 传递
}
```

**组件结构**：
```tsx
export function Hero({ locale }: HeroProps) {
  const t = useTranslations('home.hero');

  const scrollToSection = (id: string) => {
    document.getElementById(id)?.scrollIntoView({ behavior: 'smooth' });
  };

  return (
    <section className="relative min-h-[60vh] flex items-center justify-center px-4">
      <div className="container max-w-4xl mx-auto text-center space-y-8">
        {/* Badge (Logo + Title + Slogan) */}
        <motion.div initial={{ opacity: 0, y: -20 }} animate={{ opacity: 1, y: 0 }}>
          <div className="inline-flex items-center gap-2 px-4 py-2 rounded-full bg-white/10 backdrop-blur-md border border-white/20">
             {/* Logo Icon */}
             <span className="font-bold">Pixelto</span>
             <span className="text-primary">AI</span>
             <span className="text-muted-foreground text-sm border-l pl-2 ml-2 border-white/20">
               From Pixels to Everything
             </span>
          </div>
        </motion.div>

        {/* Heading */}
        <motion.h1 
          className="text-5xl md:text-6xl font-bold bg-gradient-to-r from-blue-400 to-purple-600 bg-clip-text text-transparent"
          initial={{ opacity: 0, y: 20 }}
          animate={{ opacity: 1, y: 0 }}
          transition={{ delay: 0.1 }}
        >
          {t('title')}
        </motion.h1>

        {/* Subheading */}
        <motion.p 
          className="text-xl text-muted-foreground max-w-2xl mx-auto"
          initial={{ opacity: 0 }}
          animate={{ opacity: 1 }}
          transition={{ delay: 0.2 }}
        >
          {t('subtitle')}
        </motion.p>
      </div>
    </section>
  );
}
```

---

### 3.3 AIImageEditor 优化

**移除内容**：
```diff
// apps/web/modules/ai-image-editor/AIImageEditor.tsx

- <div className="relative w-full min-h-[800px] overflow-hidden rounded-3xl border border-border/50 shadow-2xl">
-   <ParticleBackground />
-   <div className="absolute inset-0 bg-background/30 backdrop-blur-[1px]" />

+ <div className="w-full">
    {/* Content */}
+ </div>
```

**浅色主题适配**：
```tsx
// AIImageEdit.tsx 示例

<div className="bg-background/80 border-border dark:bg-zinc-900/90">
  <input 
    className="bg-background text-foreground border-border" 
    // ...
  />
</div>
```

---

### 3.4 Showcase 组件

**数据结构**：
```typescript
interface ShowcaseImage {
  id: string;
  original: string; // 原图路径
  edited: string;   // 编辑后图片路径
  prompt: string;   // 编辑提示词
  category: 'erase' | 'background' | 'style' | 'enhance';
}

const showcaseImages: ShowcaseImage[] = [
  {
    id: '1',
    original: '/showcase/original-1.webp',
    edited: '/showcase/edited-1.webp',
    prompt: 'Remove background, enhance colors',
    category: 'erase'
  },
  // ... 15-19 more
];
```

**组件实现**：
```tsx
export function Showcase() {
  const t = useTranslations('home.showcase');

  return (
    <section id="showcase" className="container mx-auto px-4 py-24">
      {/* Header */}
      <div className="text-center mb-12">
        <h2 className="text-3xl md:text-4xl font-bold mb-4">
          {t('title')}
        </h2>
        <p className="text-muted-foreground text-lg">
          {t('subtitle')}
        </p>
      </div>

      {/* Grid */}
      <div className="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6">
        {showcaseImages.map((image) => (
          <ShowcaseCard key={image.id} {...image} />
        ))}
      </div>
    </section>
  );
}

function ShowcaseCard({ original, edited, prompt }: ShowcaseImage) {
  const [isHovered, setIsHovered] = useState(false);

  return (
    <div
      className="relative aspect-square overflow-hidden rounded-lg group cursor-pointer"
      onMouseEnter={() => setIsHovered(true)}
      onMouseLeave={() => setIsHovered(false)}
    >
      {/* Image */}
      <Image
        src={isHovered ? edited : original}
        alt={prompt}
        fill
        className="object-cover transition-transform duration-300 group-hover:scale-105"
      />

      {/* Overlay */}
      <div className={`
        absolute inset-0 bg-black/50 backdrop-blur-md 
        flex items-center justify-center p-4
        transition-opacity duration-300
        ${isHovered ? 'opacity-100' : 'opacity-0'}
      `}>
        <p className="text-white text-sm text-center">{prompt}</p>
      </div>
    </div>
  );
}
```

---

### 3.5 Pricing 配置驱动

**配置文件**：
使用现有的 `config/index.ts` 中的 `payments` 字段。

**Pricing 页面**：
复用 `apps/web/modules/marketing/home/components/PricingSection.tsx` 并进行样式微调。

---

## 4. 数据库设计

### 4.1 Contact Submission 表

```prisma
// packages/database/prisma/schema.prisma

model ContactSubmission {
  id        String   @id @default(cuid())
  name      String
  email     String
  subject   String
  message   String   @db.Text
  status    String   @default("pending") // pending, reviewed, replied
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt

  @@map("contact_submission")
}
```

---

## 5. Server Actions

### 5.1 Contact Form Action

```typescript
// apps/web/app/actions/contact.ts

'use server';

import { db } from '@repo/database';
import { sendMail } from '@repo/mail';
import { z } from 'zod';

const contactSchema = z.object({
  name: z.string().min(2),
  email: z.string().email(),
  subject: z.enum(['general', 'support', 'business', 'issue']),
  message: z.string().min(20)
});

export async function submitContactForm(data: z.infer<typeof contactSchema>) {
  // 1. Validate
  const validated = contactSchema.parse(data);

  // 2. Save to DB
  const submission = await db.contactSubmission.create({
    data: validated
  });

  // 3. Send confirmation email
  await sendMail({
    to: validated.email,
    subject: 'Thank you for contacting Pixelto',
    template: 'contact-confirmation',
    data: { name: validated.name }
  });

  return { success: true, id: submission.id };
}
```

---

## 6. i18n 翻译结构

```json
// packages/i18n/translations/en.json

{
  "home": {
    "hero": {
      "badge": "New: AI-Powered Editor Now Available",
      "title": "Transform Your Images with AI",
      "subtitle": "From Pixels to Everything - Professional image editing powered by advanced AI",
      "cta": {
        "start": "Start Creating",
        "examples": "View Examples"
      }
    },
    "showcase": {
      "title": "Creative Possibilities",
      "subtitle": "See what you can create with Pixelto AI"
    },
    "features": {
      "title": "Powerful Features",
      "subtitle": "Everything you need to edit images like a pro"
    }
  },
  "pricing": {
    "toggle": {
      "monthly": "Monthly",
      "yearly": "Yearly",
      "save": "Save {{discount}}%"
    }
  }
}
```

---

> **文档版本**：v1.0  
> **创建时间**：2025-11-27  
> **维护人**：Devin  
> **状态**：✅ 设计完成
